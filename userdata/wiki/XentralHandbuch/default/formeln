<strong><span style="font-size:28px;">Formeln</span></strong><br />Mit der Anwendung von Formeln in Xentral k&ouml;nnen Sie mathematische Operationen mit den verschiedensten Feldern aus Ihren Belegen durchf&uuml;hren. Im Folgenden erl&auml;utern wir Ihnen die grundlegenden Einstellungen zur Vorbereitung und zur Anwendung des Formelkonzeptes in Xentral.<br />&nbsp;<h1>Vorbereitende Einstellungen zur Verwendung von Formeln in Xentral</h1>Grunds&auml;tzlich sollten Sie sich im Vorfeld Gedanken machen, welche Felder Sie in die Formeln einbeziehen wollen.<br /><br />Hier bietet Xentral eine Vielzahl von M&ouml;glichkeiten. Stellen Sie bitte sicher, dass die ben&ouml;tigten Bereiche entsprechend gepflegt sind. So sollte ein Freifeld mit numerischen Werten gef&uuml;llt sein, damit auch mathematische Operationen durchgef&uuml;hrt werden k&ouml;nnen.<br /><br />In Xentral k&ouml;nnen Sie grunds&auml;tzlich den Preis und die Menge in den Belegen ansprechen. Wenn Sie Freifelder nutzen, bietet sich Ihnen die M&ouml;glichkeit Ihre individuellen Anspr&uuml;che abzubilden und in Berechnungen mit einzubeziehen.<br />Allgemeine Informationen zu Freifeldern finden Sie im Artikel Freifelder.<br /><br />Um Freifelder in Formeln nutzen zu k&ouml;nnen, beachten Sie bitte Folgendes:<ul><li>Grunds&auml;tzlich wird in den Freifeldern der Inhalt aus den Stammdaten gezogen, sofern diese gepflegt sind.</li><li>Manuelle Anpassungen sind m&ouml;glich, m&uuml;ssen dann aber in der Positionsliste des Belegs vorgenommen werden.</li></ul><br />Damit k&ouml;nnen Sie jederzeit auf die Freifelder des Artikels zugreifen und m&uuml;ssen diese nicht zwingend im Beleg neu anlegen.<img src="index.php?module=wiki&amp;action=getfile&amp;workspacefolder=XentralHandbuch&amp;article=formeln&amp;fileid=1" /><ul><li>Der Haken bei &quot;Freifelder im Artikel einblenden&quot; muss gesetzt sein.</li><li>Anzeige im PDF: Hier k&ouml;nnen Sie bestimmen wo die Freifelder ausgegeben werden sollen.</li></ul>Das ist f&uuml;r die Berechnung relevant, weil nur die angezeigten Freifelder in die Berechnung miteinbezogen werden.<br /><img src="index.php?module=wiki&amp;action=getfile&amp;workspacefolder=XentralHandbuch&amp;article=formeln&amp;fileid=2" /><br />Soll der Name des Freifeldes nicht angezeigt werden, so muss die Checkbox bei &quot;Positionen mit Freifelder&quot; leer bleiben. Damit k&ouml;nnen Sie verhindern, dass zu viel Text in die Beschreibung aufgenommen wird. Brauchen Sie die Beschreibung dennoch, bitte den Haken setzen.<br /><br /><br />Anzeige ohne Haken in der Checkbox &quot;Positionen mit Freifelder&quot;:<br /><img src="index.php?module=wiki&amp;action=getfile&amp;workspacefolder=XentralHandbuch&amp;article=formeln&amp;fileid=3" /><br /><br />Anzeige mit Haken in der Checkbox &quot;Positionen mit Freifelder&quot;:<br /><img src="index.php?module=wiki&amp;action=getfile&amp;workspacefolder=XentralHandbuch&amp;article=formeln&amp;fileid=4" /><br />&nbsp;<h1>Arbeitsweise mit Formeln</h1><h2>Formeln in den Belegen</h2>Sie haben die M&ouml;glichkeit eine Formel im Editor zu erstellen und dann als K&uuml;rzel zu verwenden. Das dient der &Uuml;bersichtlichkeit und erlaubt Ihnen die Formeln zentral zu verwalten. Allerdings k&ouml;nnen Sie die Berechnungen auch direkt in der Artikelbeschreibung durchf&uuml;hren. Grunds&auml;tzlich sind die Freifelder, Menge und Preis ansprechbar.<br /><br />Unter Administration &rarr; Appstore finden Sie die App &quot;Formeln&quot;. Hier k&ouml;nnen Sie f&uuml;r verschiedene Zwecke Formeln definieren, die Sie &uuml;ber die dazugeh&ouml;rige ID im folgenden als Variable in Xentral nutzen k&ouml;nnen: {FORMEL1}<br /><img src="index.php?module=wiki&amp;action=getfile&amp;workspacefolder=XentralHandbuch&amp;article=formeln&amp;fileid=5" /><br />Nachdem man eine Kennung und einen Namen f&uuml;r die Formel vergeben hat, kann man die Formel &uuml;ber das Edit-Icon hinterlegen.<br /><br /><img src="index.php?module=wiki&amp;action=getfile&amp;workspacefolder=XentralHandbuch&amp;article=formeln&amp;fileid=6" /><br /><strong>Interpretation</strong>: In diesem Beispiel soll der eingetragene Wert des Artikels aus Freifeld 1 mit der Menge der Position1 aus dem Beleg multipliziert und letztlich durch 1000 geteilt werden, um die Zieleinheit (kW) auszugeben. Hier k&ouml;nnen die &uuml;blichen Rechenoperatoren &quot;*&quot;, &quot; / &quot;, &quot; + &quot; und &quot;-&quot; als auch &quot;sin&quot; und &quot;cos&quot; genutzt werden. Bei verschachtelten Formeln ist die Verwendung von Klammern &quot;( )&quot; gem&auml;&szlig; den mathematischen Rechengesetzen zu beachten.<br /><br />Die Formel kann dann wie folgt im Angebot, zum Beispiel im Artikelfreitext, hinterlegt und entsprechend ausgegeben werden.<img src="index.php?module=wiki&amp;action=getfile&amp;workspacefolder=XentralHandbuch&amp;article=formeln&amp;fileid=7" /><br />Dabei wird der Wert dann wie folgt auf dem Beleg, hier im Angebot, ausgegeben.<br /><img src="index.php?module=wiki&amp;action=getfile&amp;workspacefolder=XentralHandbuch&amp;article=formeln&amp;fileid=8" /><br /><br />Eine Verwendung in den Textvorlagen unter Administration &rarr; Einstellungen &rarr; Grundeinstellungen &rarr; System im Reiter &quot;Textvorlagen&quot; kann analog erfolgen.<img src="index.php?module=wiki&amp;action=getfile&amp;workspacefolder=XentralHandbuch&amp;article=formeln&amp;fileid=9" /><br /><br />Um in der Positionsansicht der Belege auch auf Mengen und Preise der anderen Positionen zugreifen zu k&ouml;nnen, ist es nun unter Stammdaten &rarr; Artikel in den Details m&ouml;glich, Formeln auf Preise und Mengen (weiterhin auch Freifelder) zu beziehen:<br /><img src="index.php?module=wiki&amp;action=getfile&amp;workspacefolder=XentralHandbuch&amp;article=formeln&amp;fileid=10" /><br /><br />In dem folgenden Beispiel wurde der Artikel als dritte Angebotsposition hinzugef&uuml;gt und die obenstehende Berechnung f&uuml;r die Menge und den Preis der Position durchgef&uuml;hrt.<br /><img src="index.php?module=wiki&amp;action=getfile&amp;workspacefolder=XentralHandbuch&amp;article=formeln&amp;fileid=11" /><br /><strong>Interpretation</strong>: Menge der Position1 = 15* Preis der Position1 = 62 = Menge von Position3 (hinzugef&uuml;gter Pos mit Formeln) geteilt durch 10 &rarr; Ergebnis auf 2 Stellen gerundet = 93<h1><br />Rechnen mit einer oder mehreren Variablen</h1>Grunds&auml;tzlich ist es in Xentral m&ouml;glich einzelne Felder aus dem Artikelstamm anzusprechen.Die Syntax daf&uuml;r ist: {{ARTIKEL:&lt;FELDNAME&gt;}}<br />Ein Feldname kann beispielsweise eine Position im Artikelstamm sein. Hier k&ouml;nnten Sie die L&auml;nge des Artikels verwenden.<br /><img src="index.php?module=wiki&amp;action=getfile&amp;workspacefolder=XentralHandbuch&amp;article=formeln&amp;fileid=12" width="700" /><br />Die dazugeh&ouml;rige Formel sieht dann so aus {{ARTIKEL:HOEHE}}: Ein m&ouml;glicher Anwendungsfall w&auml;re die Berechnung des Verkaufspreises aufgrund der Fl&auml;che eines Artikels. Damit kann man die verschiedenen Felder gem&auml;&szlig; der Rechenregeln verarbeiten.<br />In unserem Beispiel muss folgende Formel verwendet werden:<br />{{ARTIKEL:LAENGE*ARTIKEL:REITE/100}}<br /><br />Diese kann man direkt im Artikelstamm hinterlegen und damit sofort den Preis im Beleg berechnen lassen.<br />Artikel &rarr; Details<br /><img src="index.php?module=wiki&amp;action=getfile&amp;workspacefolder=XentralHandbuch&amp;article=formeln&amp;fileid=13" width="700" /><br /><br />Und erzeugt folgendes Ergebnis:<br /><br /><img src="index.php?module=wiki&amp;action=getfile&amp;workspacefolder=XentralHandbuch&amp;article=formeln&amp;fileid=14" width="700" /><br />&nbsp;<h1>Sonderfunktionen</h1>In dieser Rubrik m&ouml;chten wir Ihnen weitere M&ouml;glichkeiten vorstellen, wie Sie mit Formeln arbeiten k&ouml;nnen. Wenn Ihnen der Umgang mit Spaltenoperationen bekannt ist, wie z.B. aus Excel, haben Sie ausreichende Vorkenntnisse um die Sonderfunktionen zu nutzen. Zu Beginn zeigen wir Ihnen die grundlegenden Formatierungsm&ouml;glichkeiten, mit denen Sie das Ergebnis anpassen k&ouml;nnen. Zum Beispiel k&ouml;nnen Sie das Ergebnis einer Rechenoperation so ausgeben lassen, dass nur zwei Nachkommastellenangezeigt werden.<br /><br />Die Zahlen sind exemplarisch aufgef&uuml;hrt und k&ouml;nnen sinngem&auml;&szlig; ver&auml;ndert werden:<br />{{format(Zahl,4)}}&rarr; zeigt immer 4 Nachkommastellen an<br />{{round(Zahl,2)}}&rarr; rundet auf 2 Nachkommastellen<br />{{abs(Zahl)}}&rarr; schneidet alle Nachkommastellen ab ohne zu runden<br /><br />F&uuml;r spezielle Anwendungen stellen wir diese mathematischen Operationen zur Verf&uuml;gung:<br /><br />{{sin(Bogenma&szlig;)}}&rarr; gibt den Sinuswert des eingegeben Bogenma&szlig; zur&uuml;ck<br />{{cos(Bogenma&szlig;)}}&rarr; gibt den Cosinuswert des eingegeben Bogenma&szlig; zur&uuml;ck<br />{{sqrt(Zahl)}}&rarr; zieht die Quadratwurzel<br />{{wurzel(Radikant, Wurzelexponent}}&rarr; zieht die Wurzel mit beliebigem Radikant und Wurzelexponent<br /><br />In Xentral k&ouml;nnen Sie erweiterte Spaltenoperationen durchf&uuml;hren. Die Position, in der Formel <strong>POS</strong>: erwartet als Bezug ein Feld mit dem Sie operieren m&ouml;chten. Im unteren Beispiel haben wir die Position Preis verwendet. Analog verh&auml;lt es sich zur Position Menge. Folgende Regeln helfen Ihnen alle M&ouml;glichkeiten effizient auszusch&ouml;pfen:<ul><li>die Schreibweise POS: enth&auml;lt keine Einschr&auml;nkungen bez&uuml;glich der Position. Alle Positionen werden durchlaufen</li><li>die Schreibweise POS1: bezieht sich nur auf die Position 1</li></ul>{{spaltensumme(POS:preis * POS:menge)}}&rarr; Liefert die Summe aus (POS1:preis * POS1:menge) + (POS2:preis * POS2:menge) + (POS3:preis * POS3:menge) etc.<br />Diese Formel l&auml;uft &uuml;ber jedes Element in einem Beleg. Mit diesem Beispiel w&auml;re die Summe das &quot;Gesamt Netto&quot;.<br /><br />{{spaltensummebis(POS:preis * POS:menge)}} &rarr; Verh&auml;lt sich wie obige Formel aber liefert die Summe der Spaltenpositionen bis zur eigenen Zeile.<br />Es werden also nicht alle Positionen durchlaufen, sondern nur bis zur eigenen Position (exklusive).<br /><br />{{zwischensumme(POS:preis * POS:menge)}}&rarr; Liefert die Summe aller Positionen zwischen zwei Spezialfeldern.<br /><br />Als Spezialfelder k&ouml;nnen Sie folgende Auswahl vornehmen:<br /><img src="index.php?module=wiki&amp;action=getfile&amp;workspacefolder=XentralHandbuch&amp;article=formeln&amp;fileid=15" width="800" /><br /><br /><img src="index.php?module=wiki&amp;action=getfile&amp;workspacefolder=XentralHandbuch&amp;article=formeln&amp;fileid=16" width="600" /><br /><br /><br />Beispiel:<br />In Freifeld 1 haben Sie die jeweilige Eingangsspannung eines Servers hinterlegt. Um die Gesamtspannung in der Gruppe auszuwerten, k&ouml;nnen Sie die Freifelder 1 &uuml;ber alle Positionen addieren.<br />Da Sie Sich aber nur f&uuml;r die Gruppe Sonderausstattung interessieren, benutzen Sie bitte die Formel &quot;zwischensumme(POS:freifeld1)&quot;.Tragen Sie wie auf dem Bild die Formel in die Position des Beleges ein.<br /><br /><img src="index.php?module=wiki&amp;action=getfile&amp;workspacefolder=XentralHandbuch&amp;article=formeln&amp;fileid=17" width="900" /><br />Das Ergebnis sieht auf dem Beleg wie folgt aus:<br /><br /><img src="index.php?module=wiki&amp;action=getfile&amp;workspacefolder=XentralHandbuch&amp;article=formeln&amp;fileid=18" width="500" /><h1>Verf&uuml;gbare Variablen</h1>Die folgenden Variablen sind im Formelmodul verf&uuml;gbar*.<br /><br />Bitte ersetzen Sie jeweils das X durch eine Zahl (bei Referenzierung einer bestimmten Zeile) oder lassen es weg (bei Anwendung der Formel auf die aktuelle Zeile. Alternativ verwenden Sie statt &quot;posX&quot; das Wort &quot;artikel&quot; wenn Sie direkt auf die Artikelstammdaten zugreifen wollen ohne positionsspezifische Modifikationen zu ber&uuml;cksichtigen.<ul><li>posX:id</li><li>posX:auftrag</li><li>posX:artikel</li><li>posX:projekt</li><li>posX:bezeichnung</li><li>posX:beschreibung</li><li>posX:internerkommentar</li><li>posX:nummer</li><li>posX:menge</li><li>posX:preis</li><li>posX:waehrung</li><li>posX:lieferdatum</li><li>posX:vpe</li><li>posX:sort</li><li>posX:status</li><li>posX:umsatzsteuer</li><li>posX:bemerkung</li><li>posX:geliefert</li><li>posX:geliefert_menge</li><li>posX:explodiert</li><li>posX:explodiert_parent</li><li>posX:logdatei</li><li>posX:punkte</li><li>posX:bonuspunkte</li><li>posX:mlmdirektpraemie</li><li>posX:keinrabatterlaubt</li><li>posX:grundrabatt</li><li>posX:rabattsync</li><li>posX:rabatt1 ... posX:rabatt5</li><li>posX:einheit</li><li>posX:webid</li><li>posX:rabatt</li><li>posX:nachbestelltexternereinkauf</li><li>posX:zolltarifnummer</li><li>posX:herkunftsland</li><li>posX:artikelnummerkunde</li><li>posX:freifeld1 ... posX:freifeld40</li><li>posX:lieferdatumkw</li><li>posX:teilprojekt</li><li>posX:steuersatz</li><li>posX:steuertext</li><li>posX:erloese</li><li>posX:erloesefestschreiben</li><li>posX:einkaufspreiswaehrung</li><li>posX:einkaufspreis</li><li>posX:einkaufspreisurspruenglich</li><li>posX:einkaufspreisid</li><li>posX:ekwaehrung</li><li>posX:deckungsbeitrag</li><li>posX:formelmenge</li><li>posX:formelpreis</li><li>posX:ohnepreis</li><li>posX:potentiellerliefertermin</li><li>posX:skontobetrag</li><li>posX:steuerbetrag</li><li>posX:skontosperre</li><li>posX:ausblenden_im_pdf</li><li>posX:kostenstelle</li><li>posX:umsatz_netto_einzeln</li><li>posX:umsatz_netto_gesamt</li><li>posX:umsatz_brutto_einzeln</li><li>posX:umsatz_brutto_gesamt</li><li>posX:zolleinzelwert</li><li>posX:zollgesamtwert</li><li>posX:zollwaehrung</li><li>posX:zolleinzelgewicht</li><li>posX:zollgesamtgewicht</li></ul>Sollte einer der Werte durch das Formelmodul nicht gef&uuml;llt werden, kann das an der Belegart liegen - nicht alle Werte sind in allen Belegen verf&uuml;gbar.<br />&nbsp;<h1>Anwendungsbeispiele</h1><h2>Formel f&uuml;r die Umrechnung der St&uuml;ckzahl aus Gro&szlig;packung f&uuml;r die Produktionsanweisung</h2>Ich habe eine Produktions-St&uuml;ckliste in der verschiedene Artikel hinterlegt sind, u.a. ein Artikel den es nur als Gro&szlig;packung (Stifte) im 12er Pck gibt. F&uuml;r den Produktionsartikel werden nur 8 St&uuml;ck aus der Gro&szlig;packung ben&ouml;tigt, wie kann die St&uuml;ckliste angelegt werden, damit der Mitarbeiter aus dem Lager wei&szlig;, dass er 8 St&uuml;ck entnehmen muss. W&uuml;rde &quot;8&quot; in die St&uuml;ckliste eingetragen werden, w&auml;ren es 8 x 12er Packs statt 8 einzelne Stifte. In der St&uuml;ckliste selbst m&uuml;sste f&uuml;r den entsprechende Anteil von einem Pack f&uuml;r das Beispiel 0,666 St&uuml;ck der Gro&szlig;packung eingetragen werden. Damit der Lagermitarbeiter sich die tats&auml;chliche St&uuml;ckzahl nicht ausrechnen muss, kann diese Information mit einer Formel in einem Freifeld zus&auml;tzlich im Produktionszettel ausgegeben werden.<br /><br />Hierzu zun&auml;chst zwei Artikel Freifelder anlegen, einen f&uuml;r die VPE-Menge des Artikel und einen f&uuml;r die Formel welcher auf dem Produktionszettel ausgegeben werden soll. In dem Gro&szlig;packungsartikel muss in das eine Feld die untenstehende Formel eingetragen werden und in das andere Freifeld die VPE Menge, welche zur Berechnung in die Formel einflie&szlig;t.<br /><br />Freifelder anlegen (Administration-&gt;Einstellungen-&gt;Grundeinstellungen):<img src="index.php?module=wiki&amp;action=getfile&amp;workspacefolder=XentralHandbuch&amp;article=formeln&amp;fileid=19" /><br /><br />Formel anlegen:<br />Folgende Formel kann daf&uuml;r verwendet werden.Formel mit Rundung auf eine ganze Zahl - Freifeld Nummer entsprechend durch die Nummer des freifelds ersetzen(round(pos:menge*artikel:freifeld1,0)<br /><br />Artikel Freifelder bef&uuml;llen:<br /><br /><img src="index.php?module=wiki&amp;action=getfile&amp;workspacefolder=XentralHandbuch&amp;article=formeln&amp;fileid=20" /><br /><br />Ansicht der Produktionsanweisung mit entsprechender St&uuml;ckzahl (aufgerundet):<br /><br /><img src="index.php?module=wiki&amp;action=getfile&amp;workspacefolder=XentralHandbuch&amp;article=formeln&amp;fileid=21" />